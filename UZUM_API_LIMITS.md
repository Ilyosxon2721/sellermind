# Настройки API для Uzum Market

## Проблема
Uzum Market имеет лимиты на количество API запросов. Чтобы не превышать эти лимиты, для Uzum Market отключены:
- WebSocket автообновление в реальном времени
- Live мониторинг

## Решение

### Автообновление для Uzum Market
Вместо WebSocket используется автоматическое обновление каждые **20 минут**:
```javascript
// Uzum Market: автообновление каждые 20 минут
if (this.accountMarketplace === 'uzum') {
    setInterval(() => {
        console.log('Uzum: Auto-refresh orders (every 20 min)');
        this.loadOrders(true);
        this.loadStats();
    }, 20 * 60 * 1000); // 20 минут
}
```

### Обновление данных

Данные Uzum Market обновляются:
1. ✅ **При загрузке страницы** - автоматически
2. ✅ **Каждые 20 минут** - автоматически
3. ✅ **При ручной синхронизации** - кнопка "Синхронизировать"
4. ✅ **При перезагрузке страницы** - F5 или обновление браузера

### UI для Uzum Market

#### Что скрыто:
- ❌ Индикатор WebSocket (зелёная точка "Онлайн/Офлайн")
- ❌ Кнопка "Live ON/OFF"

#### Что показывается:
- ✅ Иконка часов с текстом "Автообновление каждые 20 мин"
- ✅ Кнопка "Синхронизировать" для ручного обновления
- ✅ Фильтры по магазинам (shop_id)
- ✅ Статистика заказов

### Для других маркетплейсов (Wildberries, Ozon, etc.)

Для всех остальных маркетплейсов работает:
- ✅ WebSocket в реальном времени
- ✅ Live мониторинг
- ✅ Автоматические уведомления о новых заказах
- ✅ Индикатор "Онлайн/Офлайн"

## Изменение интервала обновления

Чтобы изменить интервал автообновления для Uzum Market, отредактируйте файл:
`resources/views/pages/marketplace/orders.blade.php`

Найдите строку:
```javascript
}, 20 * 60 * 1000); // 20 минут
```

Измените на нужный интервал:
```javascript
}, 10 * 60 * 1000); // 10 минут
}, 30 * 60 * 1000); // 30 минут
}, 60 * 60 * 1000); // 60 минут (1 час)
```

## Рекомендации по API лимитам

### Текущие настройки:
- **Автообновление**: раз в 20 минут
- **Ручная синхронизация**: без ограничений (пользователь сам решает когда синхронизировать)
- **WebSocket**: отключен

### Если лимиты всё равно превышаются:

1. **Увеличить интервал автообновления** до 30 минут или 1 часа
2. **Отключить автообновление полностью** (оставить только ручное)
3. **Добавить throttling** на кнопку синхронизации (например, не чаще 1 раза в минуту)

### Для отключения автообновления

Закомментируйте блок в `orders.blade.php`:
```javascript
// Для Uzum Market: автообновление каждые 20 минут
/*
if (this.accountMarketplace === 'uzum') {
    setInterval(() => {
        console.log('Uzum: Auto-refresh orders (every 20 min)');
        this.loadOrders(true);
        this.loadStats();
    }, 20 * 60 * 1000);
}
*/
```

## Мониторинг API запросов

Для отслеживания API запросов к Uzum Market проверяйте логи Laravel:
```bash
tail -f storage/logs/laravel.log | grep -i uzum
```

Или посмотреть в браузере (Console):
```
Uzum: Auto-refresh orders (every 20 min)
```
