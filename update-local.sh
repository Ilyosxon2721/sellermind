#!/bin/bash

# ================================
# –°–ö–†–ò–ü–¢ –û–ë–ù–û–í–õ–ï–ù–ò–Ø –õ–û–ö–ê–õ–¨–ù–û–ì–û –ü–†–û–ï–ö–¢–ê
# ================================
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: bash update-local.sh

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞..."

# –¶–≤–µ—Ç–∞
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# ================================
# 1. GIT PULL
# ================================
echo -e "${YELLOW}[1/6] –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ GitHub...${NC}"
git pull origin main
echo -e "${GREEN}‚úì –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã${NC}"

# ================================
# 2. COMPOSER
# ================================
echo -e "${YELLOW}[2/6] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Composer –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...${NC}"
composer install
echo -e "${GREEN}‚úì Composer –æ–±–Ω–æ–≤–ª–µ–Ω${NC}"

# ================================
# 3. NPM
# ================================
echo -e "${YELLOW}[3/6] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ npm –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...${NC}"
npm install
echo -e "${GREEN}‚úì npm –æ–±–Ω–æ–≤–ª–µ–Ω${NC}"

# ================================
# 4. –ú–ò–ì–†–ê–¶–ò–ò
# ================================
echo -e "${YELLOW}[4/6] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π...${NC}"
php artisan migrate
echo -e "${GREEN}‚úì –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã${NC}"

# ================================
# 5. –û–ß–ò–°–¢–ö–ê –ö–≠–®–ê
# ================================
echo -e "${YELLOW}[5/6] –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞...${NC}"
php artisan config:clear
php artisan route:clear
php artisan view:clear
php artisan cache:clear
echo -e "${GREEN}‚úì –ö—ç—à –æ—á–∏—â–µ–Ω${NC}"

# ================================
# 6. –°–ë–û–†–ö–ê FRONTEND (DEV)
# ================================
echo -e "${YELLOW}[6/6] –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞...${NC}"
echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é: npm run dev"

echo ""
echo -e "${GREEN}‚úÖ –õ–û–ö–ê–õ–¨–ù–´–ô –ü–†–û–ï–ö–¢ –û–ë–ù–û–í–õ–ï–ù!${NC}"
echo ""
echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: npm run dev"
echo "2. –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8888 (–∏–ª–∏ –≤–∞—à MAMP URL)"
echo ""
