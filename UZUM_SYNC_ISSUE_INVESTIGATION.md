# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –£–∑—É–º

## –î–∞—Ç–∞: 2025-12-13

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É —Ä–µ–∞–ª—å–Ω—ã–º API –£–∑—É–º –∏ –Ω–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π:

| –í–∫–ª–∞–¥–∫–∞ | –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ | –£ –Ω–∞—Å –≤ –ë–î | –†–∞–∑–Ω–∏—Ü–∞ |
|---------|--------------|------------|---------|
| –í —Å–±–æ—Ä–∫–µ | 53 | 20 | -33 |
| –ü—Ä–∏–Ω—è—Ç—ã –£–∑—É–º | 61 | 0 | -61 |
| –ñ–¥—É—Ç –≤—ã–¥–∞—á–∏ | 71 | 103 | +32 |

## –ê–Ω–∞–ª–∏–∑

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```sql
SELECT status, COUNT(*) FROM marketplace_orders
WHERE marketplace_account_id = 1
GROUP BY status;
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- `in_assembly`: 20
- `in_supply`: 60
- `accepted_uzum`: 0 ‚ùå
- `waiting_pickup`: 103
- `issued`: 460
- `cancelled`: 139
- `returns`: 99

**–ò—Ç–æ–≥–æ: 881 –∑–∞–∫–∞–∑**

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ raw_payload —Å—Ç–∞—Ç—É—Å–æ–≤

```sql
SELECT raw_payload->>'status' as raw_status, COUNT(*)
FROM marketplace_orders
WHERE marketplace_account_id = 1
GROUP BY raw_payload->>'status';
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- `COMPLETED`: 474
- `CANCELED`: 136
- `DELIVERED_TO_CUSTOMER_DELIVERY_POINT`: 103
- `RETURNED`: 102
- `PENDING_DELIVERY`: 60
- `PACKING`: 20
- `DELIVERED`: 10

**–í–∞–∂–Ω–æ:** –ù–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏:
- `PROCESSING` ‚ùå
- `SHIPPED` ‚ùå
- `DELIVERING` ‚ùå
- `ACCEPTED_AT_DP` ‚ùå

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –º–µ—Ç–æ–¥–µ `externalStatusesFromInternal()` –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ —Ç—Ä–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ `$default` –º–∞—Å—Å–∏–≤–µ.

**–§–∞–π–ª:** `app/Services/Marketplaces/UzumClient.php` (—Å—Ç—Ä–æ–∫–∏ 156-171)

**–ë—ã–ª–æ:**
```php
$default = [
    'CREATED',
    'PACKING',
    'PENDING_DELIVERY',
    'DELIVERING',
    'ACCEPTED_AT_DP',
    'DELIVERED_TO_CUSTOMER_DELIVERY_POINT',
    'DELIVERED',
    'COMPLETED',
    'CANCELED',
    'PENDING_CANCELLATION',
    'RETURNED',
];
```

**–°—Ç–∞–ª–æ:**
```php
$default = [
    'CREATED',
    'AWAITING_CONFIRMATION',  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
    'PACKING',
    'PROCESSING',             // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
    'PENDING_DELIVERY',
    'SHIPPED',                // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
    'DELIVERING',
    'ACCEPTED_AT_DP',
    'DELIVERED_TO_CUSTOMER_DELIVERY_POINT',
    'DELIVERED',
    'COMPLETED',
    'CANCELED',
    'PENDING_CANCELLATION',
    'RETURNED',
];
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –≤ –ª–æ–≥–∞—Ö:

#### –°—Ç–∞—Ç—É—Å `SHIPPED` - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 400 ‚ùå

```json
{
  "status": "SHIPPED",
  "error": "Uzum API error (400): bad-request-001: Bad request"
}
```

**–í—ã–≤–æ–¥:** –°—Ç–∞—Ç—É—Å `SHIPPED` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è API –£–∑—É–º!

#### –°—Ç–∞—Ç—É—Å `DELIVERING` - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ ‚úÖ

```json
{
  "status": "DELIVERING",
  "orders_received": 0
}
```

#### –°—Ç–∞—Ç—É—Å `ACCEPTED_AT_DP` - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ ‚úÖ

```json
{
  "status": "ACCEPTED_AT_DP",
  "orders_received": 0
}
```

#### –°—Ç–∞—Ç—É—Å `PROCESSING` - –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω

–õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–ø—Ä–æ—Å–µ `PROCESSING`. –í–æ–∑–º–æ–∂–Ω–æ:
1. –ó–∞–ø—Ä–æ—Å –Ω–µ –±—ã–ª —Å–¥–µ–ª–∞–Ω –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º
2. –°—Ç–∞—Ç—É—Å —Ç–æ–∂–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è API

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ö–æ–¥–∫–∏

### 1. –°—Ç–∞—Ç—É—Å `SHIPPED` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ API –£–∑—É–º ‚ùå

API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 400 "Bad request" –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∑–∞–∫–∞–∑—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `SHIPPED`.

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å `SHIPPED` –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤.

### 2. –°—Ç–∞—Ç—É—Å—ã `DELIVERING` –∏ `ACCEPTED_AT_DP` —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –Ω–æ –ø—É—Å—Ç—ã–µ ‚úÖ

API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç—Ç–∏ —Å—Ç–∞—Ç—É—Å—ã, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –∑–∞–∫–∞–∑–æ–≤. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Å–µ–π—á–∞—Å –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ —ç—Ç–∏—Ö —Å—Ç–∞—Ç—É—Å–∞—Ö.

### 3. –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º API

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º API –£–∑—É–º:
- 53 –∑–∞–∫–∞–∑–∞ "–í —Å–±–æ—Ä–∫–µ" (—É –Ω–∞—Å —Ç–æ–ª—å–∫–æ 20 —Å `PACKING`)
- 61 –∑–∞–∫–∞–∑ "–ü—Ä–∏–Ω—è—Ç—ã –£–∑—É–º" (—É –Ω–∞—Å 0)
- 71 –∑–∞–∫–∞–∑ "–ñ–¥—É—Ç –≤—ã–¥–∞—á–∏" (—É –Ω–∞—Å 103 —Å `DELIVERED_TO_CUSTOMER_DELIVERY_POINT`)

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã API —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —ç—Ç–∏–º –≤–∫–ª–∞–¥–∫–∞–º –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –£–∑—É–º?

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### 1. ‚úÖ –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å `SHIPPED` –∏–∑ –∑–∞–ø—Ä–æ—Å–∞

–°—Ç–∞—Ç—É—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è API –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É.

### 2. ‚ùì –£–∑–Ω–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã API –£–∑—É–º

–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –£–∑—É–º Market –∏–ª–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API:
- –ö–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è "–í —Å–±–æ—Ä–∫–µ"? (–∫—Ä–æ–º–µ `PACKING`)
- –ö–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è "–ü—Ä–∏–Ω—è—Ç—ã –£–∑—É–º"?
- –ö–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è "–ñ–¥—É—Ç –≤—ã–¥–∞—á–∏"? (–∫—Ä–æ–º–µ `DELIVERED_TO_CUSTOMER_DELIVERY_POINT`)

### 3. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–∞—Ö:
1. –û–±–Ω–æ–≤–∏—Ç—å `externalStatusesFromInternal()` –≤ `UzumClient.php`
2. –û–±–Ω–æ–≤–∏—Ç—å `mapOrderStatus()` –≤ `UzumClient.php`
3. –û–±–Ω–æ–≤–∏—Ç—å `normalizeStatus()` –≤ `orders.blade.php`

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ —Å—Ç–∞—Ç—É—Å—ã (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
1. `CREATED` ‚Üí `new` ‚úÖ
2. `AWAITING_CONFIRMATION` ‚Üí `new` ‚úÖ
3. `PACKING` ‚Üí `in_assembly` ‚úÖ (20 –∑–∞–∫–∞–∑–æ–≤)
4. `PROCESSING` ‚Üí `in_assembly` ‚ùì (–Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω)
5. `PENDING_DELIVERY` ‚Üí `in_supply` ‚úÖ (60 –∑–∞–∫–∞–∑–æ–≤)
6. ~~`SHIPPED`~~ ‚Üí ~~`in_supply`~~ ‚ùå (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è API)
7. `DELIVERING` ‚Üí `accepted_uzum` ‚úÖ (0 –∑–∞–∫–∞–∑–æ–≤)
8. `ACCEPTED_AT_DP` ‚Üí `accepted_uzum` ‚úÖ (0 –∑–∞–∫–∞–∑–æ–≤)
9. `DELIVERED_TO_CUSTOMER_DELIVERY_POINT` ‚Üí `waiting_pickup` ‚úÖ (103 –∑–∞–∫–∞–∑–∞)
10. `DELIVERED` ‚Üí `issued` ‚úÖ (10 –∑–∞–∫–∞–∑–æ–≤)
11. `COMPLETED` ‚Üí `issued` ‚úÖ (474 –∑–∞–∫–∞–∑–∞)
12. `CANCELED` ‚Üí `cancelled` ‚úÖ (136 –∑–∞–∫–∞–∑–æ–≤)
13. `PENDING_CANCELLATION` ‚Üí `cancelled` ‚úÖ (0 –∑–∞–∫–∞–∑–æ–≤)
14. `RETURNED` ‚Üí `returns` ‚úÖ (102 –∑–∞–∫–∞–∑–∞)

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:
- ‚ùå `SHIPPED` - –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è API, –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
- ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è "–í —Å–±–æ—Ä–∫–µ" (33 –∑–∞–∫–∞–∑–∞ –Ω–µ —É—á—Ç–µ–Ω—ã)
- ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è "–ü—Ä–∏–Ω—è—Ç—ã –£–∑—É–º" (61 –∑–∞–∫–∞–∑ –Ω–µ —É—á—Ç–µ–Ω)
- ‚ùì –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ –¥–ª—è "–ñ–¥—É—Ç –≤—ã–¥–∞—á–∏" (+32 –∑–∞–∫–∞–∑–∞ –ª–∏—à–Ω–∏—Ö)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –£–¥–∞–ª–∏—Ç—å `SHIPPED` –∏–∑ `externalStatusesFromInternal()`
2. –ü–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤ API –£–∑—É–º –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
3. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≤ –∫–∞–∂–¥–æ–π –≤–∫–ª–∞–¥–∫–µ

---

## –°—Ç–∞—Ç—É—Å: üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ù—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã API –¥–ª—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∑–∞–∫–∞–∑–æ–≤.
