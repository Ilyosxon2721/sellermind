!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},r.exports),r.exports}var r,n,o=t((function(e,t){var r,n;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.EActionTypes||(t.EActionTypes={})).PAGE_VIEW_ACTION="page_view",r.VIEW_ACTION="view",r.SHOW_ACTION="show",r.CLOSE_ACTION="close",r.ADD_ACTION="add",r.CLEAR_ACTION="clear",r.SCREEN_CLICK="screen_click",r.DECREMENT_ACTION="decrement",r.INCREMENT_ACTION="increment",r.DISLIKE_ACTION="dislike",r.LIKE_ACTION="like",r.SET_ACTION="set",r.UNSET_ACTION="unset",r.CLICK_ACTION="click",r.SELECT_ACTION="select",r.UNSELECT_ACTION="unselect",r.REGION_SET_ACTION="region_set",r.WIDGET_VIEW_ACTION="widget_view",r.EXIT_LINK_ACTION="exit_link",r.SHARE_ACTION="share",r.SAVE_ACTION="save",r.RESTORE_ACTION="restore",r.RETURN_ACTION="return",r.BACK_ACTION="back",r.SEND="send",r.UNLOAD="unload",r.SUBMIT="submit",r.DELETE="delete",r.EDIT="edit",r.CLICK_CLUSTER="click_cluster",r.GO_TO_PAYMENT="go_to_payment",r.CLICK_CANCEL="click_cancel",r.CLICK_RETURN_ITEMS="click_return_items",r.CLICK_DELIVERY_TIME="click_delivery_time",r.PAGE_CLOSE="page_close",r.CLICK_EXTEND_DELIVERY="click_extend_delivery",r.EXTEND_DELIVERY="extend_delivery",r.CHANGE_PAYMENT_TYPE="change_payment_type",r.CLICK_RECEIVER="click_receiver",r.CHANGE_RECEIVER="change_receiver",r.CLICK_NEW_CARD="click_new_card",r.PAGE_SCROLL="page_scroll",r.CLICK_LEAVE_AT_DOOR="click_leave_at_door",r.LEAVE_AT_DOOR="leave_at_door",r.DOWNLOAD_ACTIVATION_CODE="download_activation_code",r.SWITCH_TALK_TYPE="switch_talk_type",r.PAGE_VISIBILITY_HIDDEN="page_visibility_hidden",r.PAGE_VISIBILITY_VISIBLE="page_visibility_visible",r.GROUP_IN_CART="group_in_cart",r.CART_VIEW="cart_view",r.TO_CART_ACTION="to_cart",r.TO_CART_ALL_ACTION="to_cart_all",r.REMOVE_ACTION="remove",r.REMOVE_ALL_ACTION="remove_all",r.AVAIL_ON_ACTION="avail_on",r.AVAIL_OFF_ACTION="avail_off",r.FAVORITE_ACTION="favorite",r.UNFAVORITE_ACTION="unfavorite",r.COMPARE_ACTION="compare",r.UNCOMPARE_ACTION="uncompare",r.PRICE_SUBSCRIBE_ACTION="subscribe_price",r.PRICE_UNSUBSCRIBE_ACTION="unsubscribe_price",r.SUBSCRIBE_ACTION="subscribe",r.SUBSCRIPTION_PRODUCT_ACTION="subscription_product",r.UNSUBSCRIBE_ACTION="unsubscribe",r.VOTE="vote",r.REPLY_ACTION="reply",r.RECALL_ACTION="recall",r.UNLIKE_ACTION="unlike",r.BLOCK_ACTION="block",r.UNBLOCK_ACTION="unblock",r.SPLIT_IN_PRE_ORDER="split_in_pre_order",r.FULL_VIEW_ACTION="full_view",r.PRE_ORDER_ACTION="pre_order",r.RE_ORDER_ACTION="re_order",r.CANCEL_ACTION="cancel",r.CANCEL_CONFIRM_ACTION="cancel_confirm",r.ORDER_PREMIUM_ACTION="order_premium",r.TO_CHECKOUT_ACTION="to_checkout",r.TO_CREDIT_CHECKOUT_ACTION="to_credit_checkout",r.ORDER_ACTION="order",r.BACK_TO_CART_ACTION="back_to_cart",r.ADD_ADDRESS="add_address",r.BUTTON_CLICK_ADDRESS_CHANGE_ACTION="button_click_address_change",r.CHANGE_DELIVERY_SERVICE_ACTION="change_delivery_service",r.CHANGE_SAFE_ADDRESS_ACTION="change_safe_address",r.SELECT_DELIVERY_ACTION="select_delivery",r.CHANGE_DUE_ACTION="change_due",r.CHANGE_TIME_SLOT_ACTION="change_time_slot",r.PROMOCODE_ACTIVATION_ACTION="promocode_activation",r.ADDRESS_IN_ADDRESSBOOK="address_in_addressbook",r.SELECT_ADDRESS_ACTION="select_address",r.MAP_VIEW="map_view",r.COURIER_MAP_VIEW_ACTION="courier_map_view",r.SUGGEST_REGION_ACTION="suggest_region",r.SUGGEST_COUNTRY_ACTION="suggest_country",r.SUGGEST_ADDRESS_ACTION="suggest_address",r.MAP_ADDRESS_ACTION="map_address",r.MAP_REGION_ACTION="map_region",r.REVERSE_GEOCODE_FAIL_ACTION="reverse_geocode_fail",r.CLICK_ALL_PAYMENT_ACTION="click_on_all_payment",r.PAYMENT_SUCCESS_ACTION="payment_success",r.SEARCH_ACTION="search",r.SEARCH_HELPER_ACTION="search_helper",r.CHOOSE_DEPARTAMENT_ACTION="choose_department",r.LOGIN_ACTION="login",r.LOGOUT_ACTION="logout",r.REGISTRATION_ACTION="registration",r.PHONE_CHANGE_ACTION="phone_change",r.EMAIL_CHANGE_ACTION="email_change",r.LOGIN_CHANGE_ACTION="login_change",r.PASSWORD_CHANGE_ACTION="password_change",r.REPORT_ACTION="report",r.CARD_ORDER_CLICK_ACTION="card_order_button_click",r.CARD_NEXT_BUTTON_CLICK_ACTION="next_button_click",r.CARD_NAVI_CLICK_ACTION="navigation_click",r.CARD_TERMS_CLICK_ACTION="terms_of_use_link_click",r.CARD_DONE_BUTTON_CLICK_ACTION="done_button_click",r.IMPRESSION_ACTION="impression",r.OPEN="open",r.CHAT_OPEN="open",r.DIALOG_LIST="dialog_list",r.VIDEO_VIEW="video_view",r.VIDEO_VIEW_FINISH="video_view_finish",r.VIDEO_REWIND="video_rewind",r.COVER_PREVIEW_OPEN="cover_preview_open",r.COVER_VIEW_START="cover_view_start",r.COVER_VIEW_END="cover_view_end",r.VIDEO_PREVIEW_OPEN="video_preview_open",r.VIDEO_VIEW_START="video_view_start",r.VIDEO_VIEW_END="video_view_end",(n=t.EPlatform||(t.EPlatform={})).SITE="site",n.MOBILE_SITE="mobile_site"})),i=t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=console),this._hooks=new Map,this._onError=e}return e.prototype.on=function(e,t){var r=this;if(e&&t){this._hooks.has(e)||this._hooks.set(e,new Set);var n=this._hooks.get(e);return n&&n.add(t),function(){var n=r._hooks.get(e);n&&n.delete(t)}}var o=this.hookException("Error while try to subscribe on hook without passing name or handler!");this._onError.error(o)},e.prototype.once=function(e,t){if(e&&t){var r=this.on(e,(function(e){t(e),r&&r()}));return r}var n=this.hookException("Error while try to once subscribe on hook without passing name or handler!");this._onError.error(n)},e.prototype.callHook=function(e,t){return r=this,o=function(){var r,n,o,i,a,s,c;return function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(u){switch(u.label){case 0:if(!e)return c=this.hookException("Error while try to call hook without name or passing values!"),this._onError.error(c),[2,void 0];if(r=this._hooks.get(e),!(n=r?Array.from(r):[]).length)return[3,8];o=0,u.label=1;case 1:if(!(o<n.length))return[3,8];if("function"!=typeof(i=n[o]))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,this.resolveHookPromise(i,t)];case 3:return null===(a=u.sent())||!1!==a&&"object"!=typeof a?[3,5]:[2,a];case 4:return s=u.sent(),c=this.hookException(s,i),this._onError.error(c),[2,!1];case 5:return[3,7];case 6:c=this.hookException("Hook must be type of function, but passed - "+typeof i+"!",i),this._onError.error(c),u.label=7;case 7:return o++,[3,1];case 8:return[2,void 0]}}))},new((n=void 0)||(n=Promise))((function(e,t){function i(e){try{s(o.next(e))}catch(r){t(r)}}function a(e){try{s(o.throw(e))}catch(r){t(r)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,a)}s((o=o.apply(r,[])).next())}));var r,n,o},e.prototype.resolveHookPromise=function(e,t){var r;return Promise.race([new Promise((function(r,n){var o=e(t);return o instanceof Promise?o.then((function(e){return o=e})).then(r).catch(n):r(o)})),new Promise((function(e,t){r=setTimeout(t,5e3,new Error("Time out in 5000 ms. while try to resolve hook!"))}))]).finally((function(){return clearTimeout(r)}))},e.prototype.hookException=function(e,t){var r=e instanceof Error?e:new Error("Error during call hook!"),n="string"==typeof e?new Error(e):r;return{exception:e instanceof Error?e:n,payload:{hook:void 0!==t?t.toString():"none"},zone:"hook"}},e}();t.HookEmitter=r})),a=t((function(t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=o,a=i,s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var u,l,p,f,d,E=function(){return E=Object.assign||function(e){for(var t,r=arguments,n=1,o=arguments.length;n<o;n++)for(var i in t=r[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E.apply(this,arguments)},h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},_=(u=function(e,t){var r,n;n=function(e,t){var r="XMLHttpRequest"in window?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open("POST",e,!1),r.withCredentials=!0,r.setRequestHeader("Accept","*/*"),"string"==typeof t?(r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.responseType="text/plain"):"[object Blob]"==={}.toString.call(t)&&t.type&&r.setRequestHeader("Content-Type",t.type);try{r.send(t)}catch(n){}return!0},"navigator"in(r="object"==typeof window?window:h)&&"sendBeacon"in r.navigator&&(n=navigator.sendBeacon.bind(navigator)),e.exports&&(t=e.exports=n),t.sendBeacon=n},u(l={path:void 0,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},l.exports),l.exports);function g(e){return""+(function(e){return e.indexOf("://")>0||0===e.indexOf("//")}(e)?"":window.location.origin)+e}function v(e){return"TSDK:"+e}!function(e){e.UNLOAD="unload",e.BEFORE_UNLOAD="beforeunload",e.LOAD="load"}(p||(p={})),(f=r.ETrackerHooks||(r.ETrackerHooks={})).EVENT_ADD="EVENT_ADD",f.EVENTS_SENT="EVENTS_SENT",function(e){e.START="start",e.END="end"}(d||(d={}));var y,T=function(){function e(e){this.heldEvents=[],this.sentEvents=[],this.capacity=20,this.capacity=void 0!==e.capacity?e.capacity:20}return e.prototype.addHeldEvents=function(e,t){var r,n;void 0===t&&(t=d.END),"start"===t?Array.isArray(e)?(r=this.heldEvents).unshift.apply(r,e):this.heldEvents.unshift(e):Array.isArray(e)?(n=this.heldEvents).push.apply(n,e):this.heldEvents.push(e)},e.prototype.addSentEvents=function(e){var t;(t=this.sentEvents).push.apply(t,e)},e.prototype.updateHeldEvent=function(e,t){return"object"==typeof this.heldEvents[e]&&(this.heldEvents[e].data=Object.assign({},t),!0)},e.prototype.deleteHeldEvent=function(e){return"object"==typeof this.heldEvents[e]&&(this.heldEvents.splice(e,1),!0)},e.prototype.clearHeldEvents=function(){this.heldEvents=[]},e.prototype.clearSentEvents=function(){this.sentEvents=[]},e.prototype._isFilled=function(){return this.heldEvents.length>=this.capacity},e}();function I(){return{}}function m(e){return"object"==typeof e&&null!==e}function A(){try{return m(sessionStorage)}catch(n){if("Failed to read the 'sessionStorage' property from 'Window': Access is denied for this document."===n.message)return!1;throw n}}function O(){try{return m(localStorage)}catch(n){if("Failed to read the 'localStorage' property from 'Window': Access is denied for this document."===n.message)return!1;throw n}}function b(){if(A()){var e=sessionStorage.getItem(v("pageHash"));O()&&localStorage.removeItem(v(e))}}function C(){var e=y.NAVIGATE;if("object"==typeof window&&"object"==typeof window.performance)if("object"==typeof window.performance.navigation)e=window.performance.navigation.type?y.RELOAD:y.NAVIGATE;else if("function"==typeof performance.getEntriesByType){var t=performance.getEntriesByType("navigation").map((function(e){return e.type}));e=t[0]&&"reload"===t[0]?y.RELOAD:y.NAVIGATE}return e}!function(e){e.NAVIGATE="navigate",e.RELOAD="reload",e.NAVIGATE_WITH_RELOAD="navigate_with_reload",e.NAVIGATE_IN_NEW_TAB="navigate_in_new_tab"}(y||(y={}));var N=function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="abcdef0123456789"[16*Math.random()|0];return t};function w(){return N(8)+"-"+N(4)+"-4"+N(3)+"-"+N(4)+"-"+N(12)}function S(e,t,r){var n="";if(e.length<r)for(var o=0;o<r-e.length;++o)n+=t;return n+e}function R(e,t){return e.getFullYear()+"-"+S((e.getMonth()+1).toString(),"0",2)+"-"+S(e.getDate().toString(),"0",2)+" "+S(e.getHours().toString(),"0",2)+":"+S(e.getMinutes().toString(),"0",2)+":"+S(e.getSeconds().toString(),"0",2)+(t?"."+S(e.getMilliseconds().toString(),"0",3):"")+" "+function(e){var t=e.getTimezoneOffset()>0?"-":"+",r=Math.abs(e.getTimezoneOffset());return t+S(Math.floor(r/60).toString(),"0",2)+S((r%60).toString(),"0",2)}(e)}var D=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,P=/CrOS/,k=/android|ipad|playbook|silk/i,L=function(e,t,r){this.options=t,this.event=Object.assign({},e),this.event.attributes=this.setEventAttributes(this.event.attributes);var n=this.setEventProperties(this.event.properties,r);n&&(this.event.properties=n)};function V(e){if(!e)return"";if(e.id)return'//*[@id="'+e.id+'"]';for(var t=[];e&&e.nodeType===Node.ELEMENT_NODE;){for(var r=1,n=e.previousElementSibling;n;)n.tagName===e.tagName&&r++,n=n.previousElementSibling;var o=e.tagName.toLowerCase();t.push(o+"["+r+"]"),e=e.parentElement}return"/"+t.reverse().join("/")}var M={name:"event",constructor:function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return c(t,e),t.prototype.setEventAttributes=function(e){return void 0===e&&(e={}),e.userAgent=void 0!==e.userAgent?e.userAgent:navigator.userAgent,e.platform=void 0!==e.platform?e.platform:this.options&&this.options.platform||"",e.screenResolutionX=void 0!==e.screenResolutionX?e.screenResolutionX:screen.width,e.screenResolutionY=void 0!==e.screenResolutionY?e.screenResolutionY:screen.height,e},t.prototype.setEventProperties=function(e,t){return t&&(e||(e={}),e&&(e.coordinateY=t.pageY,e.coordinateX=t.pageX,e.innerCoordinateX=t.offsetX,e.innerCoordinateY=t.offsetY,e.mapSelectedTitle=V(t.target))),e},t}(L)},j=new RegExp("eyJ(?:hbGciOiJFUz|hbGciOiJSUz|hbGciOiJIUz|hbGciOiJQUz|0eXAiOiJqd3|0eXAiOiJKV1|raWQiOi)[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+","g"),U=new Map,H=function(e){if(U.has(e))return U.get(e);if(!e.includes("eyJ"))return U.set(e,e),e;var t=e.replace(j,"______");return U.set(e,t),t},x=function(){function e(e,t){this.navigationType=C(),this.viewNumber=1,this.pageNumber=1,this.nextPageNumber=1,this.currentUrl="",this.referralUrl="",this.pageViewId=w(),this.previousPageViewId=void 0,this.currentPageType="",this.previousPageType=void 0,this.pageInit=!1,this.supplier=new Map,this.namespace=e.namespace,this.version=e.version||"unknown",this.pageTimestamp=e.pageTimestamp,this.registryEvents(t),this.registryOnInit(),window.addEventListener(p.BEFORE_UNLOAD,b)}return Object.defineProperty(e.prototype,"isMobile",{get:function(){return void 0===this._isMobile&&(this._isMobile=function(e){e||(e={});var t=e.ua;if(t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;var r=D.test(t)&&!P.test(t)||!!e.tablet&&k.test(t);return!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(r=!0),r}({tablet:!1,featureDetect:!0})),this._isMobile},enumerable:!1,configurable:!0}),e.prototype.getEventByType=function(e,t,r){void 0===t&&(t={});var o=this.supplier.get(e);if(void 0===o)throw new Error("Не удалось получить конструктор события по ключу - "+e);var i=new o(t,{platform:this.isMobile?n.EPlatform.MOBILE_SITE:n.EPlatform.SITE},r).event;return i.actionType===n.EActionTypes.PAGE_VIEW_ACTION&&(this.savePageViewInformation(i.page),this.currentPageType="object"==typeof i.page&&void 0!==i.page.current?i.page.current:"",this.enrichEvent(i)),i.actionType===n.EActionTypes.PAGE_VISIBILITY_VISIBLE&&this.enrichEvent(i),i.timestamp=i.timestamp||R(new Date),i.timestampMs=i.timestampMs||R(new Date,!0),i.pageTimestamp=this.pageTimestamp,i.attributes.namespace=i.actionType===n.EActionTypes.SCREEN_CLICK?"native":this.namespace,i.attributes.appVersion||(i.attributes.appVersion=v(this.version)),i.uuid=i.uuid||w(),i},e.prototype.enrichEvent=function(e){return void 0===e&&(e={}),e.page=Object.assign({},e.page),e.page.number=this.pageNumber,e.page.currentUrl=H(this.currentUrl),e.page.current=this.currentPageType,e.page.referralUrl=H(this.referralUrl),e.page.previous=this.previousPageType,e.page.pageViewId=this.pageViewId,e.page.previousPageViewId=this.previousPageViewId,e.page.isActiveTab=!document.hidden,e},e.prototype.registryEvents=function(e){if(this.supplier.set(M.name,M.constructor),Array.isArray(e))for(var t=0;t<e.length;t++){var r=e[t];r.name!==M.name&&this.supplier.set(r.name,r.constructor)}},e.prototype.registryOnInit=function(){var e=A()?sessionStorage.getItem(v("pageHash")):null,t=A()?sessionStorage.getItem(v("customReferrer")):"";this.pageInit=function(){if(A()){var e=C(),t=sessionStorage.getItem(v("pageInit"));return null!==t&&"false"!==t&&e!==y.RELOAD||(sessionStorage.setItem(v("pageInit"),"true"),!1)}return!1}();var r=this.pageInit&&null!==e&&!document.referrer?e:document.referrer;this.currentUrl=window.location.href,this.referralUrl=this.navigationType===y.RELOAD&&null!==t?t:r,!A()||null!==t&&""!==t&&this.navigationType===y.RELOAD||sessionStorage.setItem(v("customReferrer"),document.referrer);var n=g(this.referralUrl||"/");document.referrer!==n&&Object.defineProperty(document,"referrer",{value:n,writable:!0,configurable:!0});var o=function(){if(A()){var e=sessionStorage.getItem(v("nextPageNumber"));return null!==e?e:null}return null}();null!==o&&(this.pageNumber=Number(o),this.nextPageNumber=this.pageNumber),this.getInformationFromStorage()},e.prototype.setViewNumber=function(){var e=this.viewNumber++;return this.viewNumber>=Number.MAX_SAFE_INTEGER&&(this.viewNumber=1),e},e.prototype.setNextPageNumber=function(){var e=this.nextPageNumber++;return this.nextPageNumber>=Number.MAX_SAFE_INTEGER&&(this.nextPageNumber=1),e},e.prototype.savePageViewInformation=function(e){void 0===e&&(e={}),this.pageNumber=this.setNextPageNumber();var t,r=this.setViewNumber();this.pageNumber>1&&(this.pageViewId=w(),this.pageInit&&this.trackPageTransition(r,e.currentUrl,e.referralUrl)),t=this.nextPageNumber,A()&&sessionStorage.setItem(v("nextPageNumber"),String(t)),this.pageInit&&O()&&localStorage.removeItem(v(this.referralUrl)),function(e,t){var r=C();if(A()){sessionStorage.setItem(v("pageHash"),e);var n=JSON.parse(sessionStorage.getItem(v("pageData"))||"{}"),o=Object.keys(n);2===o.length&&r!==y.RELOAD&&delete n[o[0]],n[e]=t,sessionStorage.setItem(v("pageData"),JSON.stringify(n))}O()&&localStorage.setItem(v(e),JSON.stringify(t))}(this.currentUrl,{pageViewId:this.pageViewId,pageType:e.current}),this.pageInit=!0},e.prototype.trackPageTransition=function(e,t,r){var n=e>1;n&&void 0===t&&console.warn("При spa-переходе необходимо прокидывать обновлённый url в page.currentUrl.");var o,i=n?this.currentUrl:this.referralUrl;n&&(document.referrer!==i&&Object.defineProperty(document,"referrer",{value:i,writable:!0,configurable:!0}),o=y.NAVIGATE===y.RELOAD?1:0,"object"==typeof window&&("object"==typeof window.performance.navigation?Object.defineProperties(window.performance.navigation,{type:{value:o,writable:!0}}):Object.defineProperties(window.performance,{navigation:{value:{type:o},writable:!0}})),A()&&sessionStorage.setItem(v("customReferrer"),i));var a=void 0!==r?r:i;this.currentUrl=g(void 0!==t?t:this.currentUrl),this.referralUrl=g(a||"/"),this.getInformationFromStorage()},e.prototype.getInformationFromStorage=function(){var e=function(e){if(A()&&O()){var t=""!==e?e:sessionStorage.getItem(v("pageHash")),r=sessionStorage.getItem(v("pageData"));if(null!==t&&null!==r){var n=JSON.parse(r||"{}");return"object"==typeof n[t]&&Object.keys(n[t]).length?n[t]:{}}return JSON.parse(localStorage.getItem(v(e))||"{}")}return{}}(this.referralUrl);this.saveData(e)},e.prototype.saveData=function(e){this.previousPageType=e.pageType,this.previousPageViewId=e.pageViewId},e}();function G(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===B}(e)}(e)}(r.EDefaultEvents||(r.EDefaultEvents={})).EVENT="event";var B="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function K(e,t){return!1!==t.clone&&t.isMergeableObject(e)?z(Array.isArray(e)?[]:{},e,t):e}function W(e,t,r){return e.concat(t).map((function(e){return K(e,r)}))}function F(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function Y(e,t){try{return t in e}catch(s){return!1}}function z(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||W,r.isMergeableObject=r.isMergeableObject||G,r.cloneUnlessOtherwiseSpecified=K;var n=Array.isArray(t);return n===Array.isArray(e)?n?r.arrayMerge(e,t,r):function(e,t,r){var n={};return r.isMergeableObject(e)&&F(e).forEach((function(t){n[t]=K(e[t],r)})),F(t).forEach((function(o){(function(e,t){return Y(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(n[o]=Y(e,o)&&r.isMergeableObject(t[o])?function(e,t){if(!t.customMerge)return z;var r=t.customMerge(e);return"function"==typeof r?r:z}(o,r)(e[o],t[o],r):K(t[o],r))})),n}(e,t,r):K(t,r)}function X(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return e;if(e instanceof String)return e;if(e instanceof Number)return e;if(e instanceof Boolean)return e;if(e instanceof RegExp)return e;var t={};for(var r in e instanceof Array&&(t=new Array(e.length)),e)t[r]=X(e[r]);return t}var q=function(e){function t(t,r){var n=e.call(this)||this;n.isTMEnabled=!1,n.isTMAllowed=!1,n.isPageViewSent=!1,n.isPageCloseSent=void 0,n.isOnUnload=!1,n.scrollDepth=0,n.pageStartTimestamp=0,n.needXHR=void 0,n.checkScrollDeep=function(){window.scrollY>n.scrollDepth&&(n.scrollDepth=window.scrollY)},n.pageStartTimestamp=Date.now(),n.isTMAllowed=Boolean(t.manager&&t.manager.enable)||document.cookie.includes("ozon_devtools");try{n.config=function(e){var t=Object.assign({},e);if(!t.namespace)throw new Error("Необходимо установить параметр namespace в конструктор Tracker SDK");t.dev=void 0!==t.dev&&t.dev;var r="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n=r||t.dev?"https://trinity-storage-stg.ozonru.me/v1/json-payloads":"https://trinity-storage.t.o3.ru/v1/json-payloads",o=r||t.dev?"https://cdn-qa.ozonru.me":"https://cdn2.ozone.ru",i=r||t.dev?"https://cdn-qa.ozonru.me":"https://cdn2.ozone.ru";return t.host=void 0!==t.host?t.host:r||t.dev?"https://xapi-stg.ozonru.me/dlte/multi":"https://xapi.ozon.ru/dlte/multi",t.dynamicApiHost&&(t.host=document.location.origin+"/p-api/tracker/dlte/multi"),t.trinityStorageUrl=void 0!==t.trinityStorageUrl?t.trinityStorageUrl:n,t.manager={enable:"object"==typeof t.manager&&"boolean"==typeof t.manager.enable&&t.manager.enable,host:"object"==typeof t.manager&&"string"==typeof t.manager.host?t.manager.host:o},t.metrics={enable:"object"==typeof t.metrics&&"boolean"==typeof t.metrics.enable&&t.metrics.enable,host:"object"==typeof t.metrics&&"string"==typeof t.metrics.host?t.metrics.host:i},t.sendTimeout=void 0!==t.sendTimeout?t.sendTimeout:2e4,t.pageViewEnabled=void 0===t.pageViewEnabled||t.pageViewEnabled,t.pageCloseEnabled=void 0===t.pageCloseEnabled||t.pageCloseEnabled,t.eventTemplate="function"==typeof t.eventTemplate?t.eventTemplate:I,t.pageAdditional=void 0!==t.pageAdditional?t.pageAdditional:{},t}(Object.assign({},t))}catch(u){throw console.error(u),u}try{n.store=new T({capacity:n.config.capacity})}catch(l){throw console.error(l),l}try{n.factory=new x({namespace:n.config.namespace,version:n.config.version,pageTimestamp:R(new Date(n.pageStartTimestamp))},r)}catch(f){throw console.error(f),f}return n.sendTimeout=n.config.sendTimeout,setTimeout((function(){if(-1!==("object"==typeof PerformanceObserver&&Array.isArray(PerformanceObserver.supportedEntryTypes)||[]).indexOf("layout-shift")){var e=function(){n.sendVisibilityChangeEvent(),"hidden"===document.visibilityState&&(n.flush(),removeEventListener("visibilitychange",e,!0))};addEventListener("visibilitychange",e,!0)}else addEventListener("pagehide",(function(){return n.flush()}),{capture:!0,once:!0})})),window.addEventListener("scroll",n.checkScrollDeep),window.addEventListener("pageshow",(function(e){e.persisted&&(n.isPageCloseSent=!1)})),window.addEventListener(p.BEFORE_UNLOAD,(function(){n.isOnUnload=!0,n.config.pageCloseEnabled?n.sendPageClose():n.flush()})),n}return c(t,e),t.prototype.setTMFlag=function(e){this.isTMEnabled=e},t.prototype.sendVisibilityChangeEvent=function(){if(document.hidden){var e={viewTime:Date.now()-this.pageStartTimestamp,scrollDepth:this.scrollDepth};this.sendCustomPageEvent(n.EActionTypes.PAGE_VISIBILITY_HIDDEN,e)}else this.sendCustomPageEvent(n.EActionTypes.PAGE_VISIBILITY_VISIBLE,{})},t.prototype.sendPageView=function(e){void 0===e&&(e={});var t=X(e);this.isPageViewSent=!1,this.isPageCloseSent=void 0,this.sendCustomPageEvent(n.EActionTypes.PAGE_VIEW_ACTION,t)},t.prototype.sendPageClose=function(e){void 0===e&&(e={});var t=X(e);t.viewTime=Date.now()-this.pageStartTimestamp,t.scrollDepth=this.scrollDepth,this.factory.pageInit&&!this.isPageCloseSent&&(this.isPageCloseSent=!1,this.sendCustomPageEvent(n.EActionTypes.PAGE_CLOSE,t))},t.prototype.sendEvent=function(e,t,n){void 0===t&&(t={});var o=this.factory.getEventByType(r.EDefaultEvents.EVENT,e,n);return this.add({key:r.EDefaultEvents.EVENT,data:o},t)},t.prototype.add=function(e,t){var n=this;void 0===t&&(t={});var o=X(e);if(!this.isPageViewSent)return this.store.addHeldEvents(o),!0;var i=Array.isArray(o)?o.map((function(e){return{key:e.key,data:n.factory.enrichEvent(e.data)}})):{key:o.key,data:this.factory.enrichEvent(o.data)};if(!1===this.isPageCloseSent||this.isOnUnload&&void 0===this.isPageCloseSent)return void 0!==this.sendTimerId&&clearTimeout(this.sendTimerId),this.store.addHeldEvents(i),!0;this.store._isFilled()&&this.sendEvents();var a=t.force,s=void 0!==a&&a;return this.store.addHeldEvents(o),this.callHook(r.ETrackerHooks.EVENT_ADD,o).catch(console.error),void 0!==this.sendTimerId&&clearTimeout(this.sendTimerId),s?(this.flush(),!this.store._isFilled()):(this.isTMEnabled||(this.sendTimerId=setTimeout((function(){n.sendEvents()}),this.sendTimeout)),!this.store._isFilled())},t.prototype.flush=function(){return void 0!==this.sendTimerId&&(clearTimeout(this.sendTimerId),this.sendTimerId=void 0),this.sendEvents(),!0},t.prototype.sendXHR=function(e,t){return r=this,o=function(){return function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(r){return[2,new Promise((function(r,n){var o=new Error("Analytics sent XHR error"),i=new XMLHttpRequest,a=function(){i.removeEventListener("load",s),i.removeEventListener("error",c)},s=function(){a(),200===i.status?r(!0):c(o)},c=function(e){a(),n(e instanceof Error?e:o)};i.open("POST",e,!0),i.addEventListener("load",s),i.addEventListener("error",c),i.send(t)}))]}))},new((n=void 0)||(n=Promise))((function(e,t){function i(e){try{s(o.next(e))}catch(r){t(r)}}function a(e){try{s(o.throw(e))}catch(r){t(r)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,a)}s((o=o.apply(r,[])).next())}));var r,n,o},t.prototype.sendData=function(e,t){return new Blob([t]).size>=65536?(this.sendXHR(e,t).catch((function(e){return console.error(e)})),!0):_(e,t)},t.prototype.sendEvents=function(){var e=this.store.heldEvents.concat();if(!e.length)return!1;var t=e.map((function(e){var t;return(t={})[e.key]=e.data,t})),n=function(e){return'{"events":'+e+"}"}(JSON.stringify(t)),o=this.sendData(this.config.host,n);return o&&(this.store.clearHeldEvents(),this.isTMAllowed&&this.store.addSentEvents(e),this.callHook(r.ETrackerHooks.EVENTS_SENT,e).catch(console.error)),o},t.prototype.sendCustomPageEvent=function(e,t){var o=this;void 0===t&&(t={}),t.actionType=e,t.object=E(E({},t.object),{type:"page"});var i="function"==typeof this.config.eventTemplate?this.config.eventTemplate():{},a=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return z(e,r,t)}),{})}([this.config.pageAdditional,i,t],{}),s=this.factory.getEventByType(r.EDefaultEvents.EVENT,a);s.actionType!==n.EActionTypes.PAGE_VIEW_ACTION&&s.actionType!==n.EActionTypes.PAGE_VISIBILITY_VISIBLE||(this.store.heldEvents=this.store.heldEvents.concat().map((function(e){return E(E({},e),{data:o.factory.enrichEvent(e.data)})})),this.store.addHeldEvents({key:r.EDefaultEvents.EVENT,data:s},d.START),this.isPageViewSent=this.sendEvents()),s.actionType!==n.EActionTypes.PAGE_CLOSE&&s.actionType!==n.EActionTypes.PAGE_VISIBILITY_HIDDEN||(this.store.addHeldEvents({key:r.EDefaultEvents.EVENT,data:this.factory.enrichEvent(s)}),this.isPageCloseSent=this.sendEvents())},t}(a.HookEmitter),J=function(){function e(){}return e.prototype.createTrackerCore=function(e,t){return"object"==typeof this.core||(this.core=new q(e,t)),this.core},e.prototype.on=function(e,t){return this.core.on(e,t)},e.prototype.once=function(e,t){return this.core.once(e,t)},e.prototype.setTMFlag=function(e){"object"==typeof this.core&&this.core.setTMFlag(e)},e.prototype.flush=function(){"object"==typeof this.core&&this.core.flush()},e.prototype.sendEvents=function(){return"object"==typeof this.core&&this.core.sendEvents()},e}();r.CommonEventModel=L,r.SHOW_MANAGER_COOKIE_NAME="tracker_manager",r.SHOW_METRICS_COOKIE_NAME="tracker_metrics",r.TRACKER_KEY_WITH_PREFIX=v,r.Tracker=q,r.TrackerCoreInitialize=J,r.WINDOW_TRACKER_FIELD="$tracker",r.generateClickHouseUUID=w,r.getXPathForElement=V,r.nanoid=N})),s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},c=function(){return c=Object.assign||function(e){for(var t,r=arguments,n=1,o=arguments.length;n<o;n++)for(var i in t=r[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)},u=t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TM_LOCAL_HOST="http://localhost:5192",t.TM_NEED_LOCALHOST_COOKIE_NAME="tm_local",t.loadTrackerManagerScript=function(e,t){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.async=!0,r.src=e+"/s3/oztm/3.1.0/manager.js",void 0!==t&&r.setAttribute("nonce",t),n.parentNode&&n.parentNode.insertBefore(r,n);var o=setInterval((function(){if(window.$trackerManager&&"function"==typeof window.$trackerManager){var e=window.$trackerManager,t=document.createElement("div");t.setAttribute("id","tracker-manager"),t.style.cssText="position: sticky; top: 0; z-index: 9999;";var r=document.querySelector("#__ozon");document.body.insertBefore(t,r),new e({target:t}),clearInterval(o)}}),1e3)}})),l=(r={read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},n={path:"/"},Object.create({set:function(e,t,o){if("undefined"!=typeof document){o=function(e){for(var t=arguments,r=[],n=1;n<arguments.length;n++)r[n-1]=t[n];for(var o=1;o<r.length;o++){var i=r[o];for(var a in i)e[a]=i[a]}return e}({},n,o),"number"==typeof o.expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=e+"="+r.write(t,e)+i}},get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},o=0;o<t.length;o++){var i=t[o].split("="),a=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(s in n||(n[s]=r.read(a,s)),e===s)break}catch(c){}}return e?n[e]:n}}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(r)}}));function p(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===f}(e)}(e)}var f="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function d(e,t){return!1!==t.clone&&t.isMergeableObject(e)?g(Array.isArray(e)?[]:{},e,t):e}function E(e,t,r){return e.concat(t).map((function(e){return d(e,r)}))}function h(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function _(e,t){try{return t in e}catch(r){return!1}}function g(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||E,r.isMergeableObject=r.isMergeableObject||p,r.cloneUnlessOtherwiseSpecified=d;var n=Array.isArray(t);return n===Array.isArray(e)?n?r.arrayMerge(e,t,r):function(e,t,r){var n={};return r.isMergeableObject(e)&&h(e).forEach((function(t){n[t]=d(e[t],r)})),h(t).forEach((function(o){(function(e,t){return _(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(n[o]=_(e,o)&&r.isMergeableObject(t[o])?function(e,t){if(!t.customMerge)return g;var r=t.customMerge(e);return"function"==typeof r?r:g}(o,r)(e[o],t[o],r):d(t[o],r))})),n}(e,t,r):d(t,r)}var v=function(e){function t(){var t=e.call(this)||this;return t.version="3.1.0",t.trackerSessionId="",t.pageAdditional={},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.init=function(e){var t=["live-webinars","calculator-ui","sc","GlobalLanding","profit-portal-fe","principal-ui","docs","sx-docs","sc-landing","su-onboarding","technical-partner-ui","kms-public"].includes(e.namespace);if(this.pageAdditional=e.pageAdditional||{},!t){var r=l.get("TSDK_trackerSessionId");r?this.trackerSessionId=r:(this.trackerSessionId=a.nanoid(8)+"-"+a.nanoid(4)+"-"+a.nanoid(4)+"-"+a.nanoid(4),l.set("TSDK_trackerSessionId",this.trackerSessionId)),this.pageAdditional=g({user:{sessionId:this.trackerSessionId}},this.pageAdditional,{})}var n=e.manager||{},o=e.metrics||{},i=this.createTrackerCore(c(c({},e),{manager:c(c({},n),{enable:"boolean"==typeof n.enable?n.enable:Boolean(l.get(a.SHOW_MANAGER_COOKIE_NAME))}),metrics:c(c({},o),{enable:"boolean"==typeof o.enable?o.enable:Boolean(l.get(a.SHOW_METRICS_COOKIE_NAME))}),version:this.version,pageAdditional:this.pageAdditional}));if("object"!=typeof window||a.WINDOW_TRACKER_FIELD in window||(window[a.WINDOW_TRACKER_FIELD]=this),"object"==typeof i.config.manager&&i.config.manager.enable){var s=l.get(u.TM_NEED_LOCALHOST_COOKIE_NAME);u.loadTrackerManagerScript(s?u.TM_LOCAL_HOST:i.config.manager.host,i.config.cspNonce)}return i.config.pageViewEnabled&&this.sendPageView(),this},t.prototype.sendPageView=function(e){void 0===e&&(e={}),"object"==typeof this.core&&this.core.sendPageView(e)},t.prototype.sendPageClose=function(e){void 0===e&&(e={}),"object"==typeof this.core&&this.core.sendPageClose(e)},t.prototype.sendEvent=function(e,t,r){if(void 0===t&&(t={}),"object"==typeof this.core){var n=g("function"==typeof this.core.config.eventTemplate?this.core.config.eventTemplate():{},e,{}),o=this.core.factory.getEventByType(a.EDefaultEvents.EVENT,n,r);return""!==this.trackerSessionId&&(o.user=o.user||{},o.user.sessionId=void 0!==o.user.sessionId?o.user.sessionId:this.trackerSessionId),o=g(o,this.pageAdditional,{}),this.core.add({key:a.EDefaultEvents.EVENT,data:o},t)}return!1},t}(a.TrackerCoreInitialize);"object"!=typeof window||a.WINDOW_TRACKER_FIELD in window||(window[a.WINDOW_TRACKER_FIELD]=new v)}();
